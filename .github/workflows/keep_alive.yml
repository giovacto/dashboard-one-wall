name: Wake Up Streamlit

on:
  schedule:
    # Esegue l'azione ogni 15 minuti
    - cron: '*/15 * * * *'
  workflow_dispatch: # Permette di avviarlo anche manualmente per test

jobs:
  wake-up:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install Playwright
        run: |
          pip install playwright
          playwright install chromium

      - name: Visit Streamlit App
        run: |
          python -c "
          from playwright.sync_api import sync_playwright
          with sync_playwright() as p:
              browser = p.chromium.launch(headless=True)
              page = browser.new_page()
              # URL SISTEMATO QUI SOTTO
              url = 'https://dashboard-one-wall-8nzuh5q9skdycad8o27lcd.streamlit.app/'
              print(f'Visitando {url}...')
              page.goto(url, wait_until='networkidle')
              page.wait_for_timeout(5000) 
              print('Pagina caricata con successo!')
              browser.close()
          "
